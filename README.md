# Thesis Project: Evaluation of Geometrical Accuracy in Single-Isocenter Multi-Target Cranial Stereotactic Radiotherapy and Stereotactic Radiosurgery
## Abstract 
### Introduction
Radiotherapy (RT), together with surgery and chemotherapy, is one of the three main modalities used in the treatment of cancer. Nowadays, thanks to the advanced technological development of imaging equipment, Image-Guided Radiotherapy (IGRT) has been introduced. It allows visualization of the patientâ€™s anatomy prior to radiation fraction delivery, allowing accurate knowledge of the location of the target volume. IGRT has also been integrated with Stereotactic Radiotherapy (SRT) and Stereotactic Radiosurgery (SRS): this combination of procedures is the actual standard for treating particularly sensitive and less-evident zones, such as very small lesions in the cranium.

IGRT is based on the integration of two fundamental imaging systems on the Linear Accelerator (LINAC): a kV X-ray source with its flat imaging panel, i.e., On-Board Imaging (OBI), and an MV X-ray source with the respective flat imaging panel, i.e., Electronic Portal Imaging (EPI). Both of them are used for assessing patient positioning before treatment and have the possibility to perform 2D and 3D volume acquisitions; the latter also represents the high-dose X-ray source for effective patient treatment. Once an IGRT system is commissioned, it is necessary to perform periodic Quality Assurance (QA) controls to ensure optimal therapy outcomes. In particular, geometric accuracy aims to verify the setting of the patient and X-ray beams.

The purpose of this work is to develop an automatic method to evaluate the alignments of multiple targets - simulating distributed metastases - and Multi-Leaf Collimator (MLC) irradiation beam fields from a cranial phantom in single isocenter treatments, after previous registration with the OBI system. The need for this task stems from the problem that MV image analysis, due to low subject contrast and low signal-to-noise ratio, is still performed by hand. Therefore, an automatized process is needed. Specifically, this method performs analysis and comparisons of paired 2D Digital Reconstructed Radiographs (DRRs) and Portal images, enabling
sub-millimeter accuracy and an 88% speedup compared with current manually performed QA processes.

### Results and Discussion
The first aim is to quantify the displacements between corresponding spheres in DRR and Portal images. For this purpose, we adopted Euclidian distance in pixel coordinates (converted then in millimeters) on 2D images to evaluate the shifts of identified sphere centers.

Firstly, to check the effectiveness of the shape identification algorithm, we compared the detected sphere centers coordinates of DRR and Portal Images with centers manually localized by a skilled medical physicist operator through 3D Slicer, an open-source software package widely used in this domain. The differences between the two identification methods for each sphere center in DRR images never exceeded the value of 0.3mm. In particular, they resulted in average values of 0.20395mm for ANT image, 0.197mm for LAT D image, 0.198725mm for LAT G image, and 0.21185mm for POST image, considering all spheres. These results certainly depend on the high contrast that characterizes DRR images and facilitates the identification of the centers of the spheres for both our implemented method and the operator. For what concerns Portal images we registered average values of 0.229525mm for
ANT image, 0.289525mm for LAT D image, 0.285275mm for LAT G image, and 0.38435mm for POST image. The differences between the two methods are still good but a bit higher with respect to the previous case, mainly due to the lower signal-to-noise ratio and artifacts that characterize Portal images.

After that, we performed the computation of displacements between corresponding spheres. The displacements represent the accuracy of the registration phase and the alignment between the EPI and OBI systems. We evaluated these displacements firstly considering the results coming from our identification method, and then considering manual identification. The displacements have been measured again through 2D Euclidean distance of pixel coordinates for each pair of spheres in superimposed correspondent DRR and Portal images. Considering our identification method we registered average displacements of 0.5356mm for sphere 1, 0.7152mm for sphere 2, 0.5864mm for sphere 3, and 0.4959mm for sphere 4. With manual identification, on the other side, we registered 0.6169mm for sphere 1, 0.7247mm for sphere 2, 0.7084mm for sphere 3, and 0.5063mm for sphere 4 as average values. These results show how the two identification methods do not significantly differ and that the registration phase, together with the alignment of EPI and OBI systems are accurate, strictly below 1.5mm threshold, even if we take into account the uncertainties due to the different methods.

For what concerns irradiation beam fields, the principle is the same. Couples of corresponding irradiation fields, belonging to paired spheres, were superimposed and their distances were then computed. Here we considered the reconstructed coordinates from DICOM tags as ground truth irradiation fields, and the algorithm-identified coordinates as detected irradiation fields. In this case, the displacements have been evaluated on the four sides of each irradiation field, where the threshold not to be exceeded is still 1.5mm. Edge displacements have been computed by considering the maximum value between the differences of the paired coordinates of
the extremes for each edge. In general, all the displacements fall into the desired threshold. There are a few peaks of 1.3327mm and 1.2543mm, while all the other cases remain below 1mm. Also, comparing the two methods, we registered how there is not a significant difference between them, which resulted in a maximum of 0.1252mm for irradiation field 2.

Finally, we compared the performances of the entire automatized process through our developed program with the manually performed process. For what concerns the manual process, we considered the execution by an expert medical physician and we took average values for each phase. It is clear that from a computational point of view, the procedure executed by our developed program is way faster than the manual process, allowing us to speed up the entire pipeline of execution by 88%.

### Conclusions
In this work, a new automatic method was developed for measuring the displacements of multiple cranial phantom sphere targets and their irradiation fields on 2D Portal images, relative to their theoretical positions in 2D DRR images. In particular, the need for this solution arises from the problem that in IGRT SRT/SRS QA processes, the analysis is still manually performed by a medical physicist operator due to two main factors: firstly, MV images are subjected to significant noise and low contrast resolution, because of the high dose emitted. In addition, this type of treatment is characterized by a single isocenter and multiple targets, a rather new irradiation technique within our institute, which still needs automatized verification tests.

This method has been compared with the manual process in terms of procedural delays. The manual method, whose measurements have been considered performed by an expert medical physicist, took approximately 25min, while the automatic procedure required about 3min, allowing a speed-up of 88%.

This process of automatic evaluation sits after the OBI registration phase in QA geometrical accuracy pipeline. It aims to be an end-to-end test for MV system as well as LINAC treatment head. In particular, the measured sphere displacements will represent misalignments between OBI and EPI systems or treatment couch correction problems, while irradiation field shifts could also depend on MLC or jaws mechanical calibration inaccuracies. It is a follow-up task to further investigate with specific tests and identify the source of error.
